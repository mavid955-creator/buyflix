<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Product Details - BuyFlix</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header class="navbar">
    <div class="logo" onclick="goHome()">ðŸ›’ BuyFlix</div>
  </header>

  <section class="product-details" id="productDetails"></section>

  <section class="review-section">
    <h2>Customer Reviews</h2>
    <div id="reviewsList"></div>

    <div class="add-review">
      <h3>Add Your Review</h3>
      <div class="stars" id="stars">
        <span onclick="setRating(1)">â˜…</span>
        <span onclick="setRating(2)">â˜…</span>
        <span onclick="setRating(3)">â˜…</span>
        <span onclick="setRating(4)">â˜…</span>
        <span onclick="setRating(5)">â˜…</span>
      </div>
      <textarea id="reviewText" placeholder="Write your review..."></textarea>
      <button onclick="submitReview()">Submit</button>
    </div>
  </section>

  <script>
    const products = [
      { id: 1, name_en: "Smartphone", price: "â‚¹19,999", img: "https://images.unsplash.com/photo-1511707171634-5f897ff02aa9", desc_en: "High-speed 5G smartphone with amazing camera." },
      { id: 2, name_en: "Headphones", price: "â‚¹2,499", img: "https://images.unsplash.com/photo-1517336714731-489689fd1ca8", desc_en: "Noise cancelling wireless headphones." },
      { id: 3, name_en: "Laptop", price: "â‚¹59,999", img: "https://images.unsplash.com/photo-1517336714731-489689fd1ca8", desc_en: "Powerful laptop for work and gaming." },
      { id: 4, name_en: "Smart Watch", price: "â‚¹3,499", img: "https://images.unsplash.com/photo-1517248135467-4c7edcad34c4", desc_en: "Track your fitness and stay connected." },
    ];

    const productId = localStorage.getItem("selectedProduct");
    const product = products.find(p => p.id == productId);
    const reviewsKey = `reviews_${productId}`;

    const div = document.getElementById("productDetails");
    div.innerHTML = `
      <div class="details-card">
        <img src="${product.img}" alt="${product.name_en}">
        <h2>${product.name_en}</h2>
        <p>${product.desc_en}</p>
        <p><strong>${product.price}</strong></p>
        <button onclick="goHome()">Back to Home</button>
      </div>
    `;

    // â­ Review System
    let selectedRating = 0;

    function setRating(star) {
      selectedRating = star;
      const spans = document.querySelectorAll('#stars span');
      spans.forEach((s, i) => {
        s.classList.toggle('active', i < star);
      });
    }

    function submitReview() {
      const text = document.getElementById("reviewText").value.trim();
      if (!text || selectedRating === 0) return alert("Please give rating and write a review.");

      const review = {
        rating: selectedRating,
        text,
        date: new Date().toLocaleString()
      };

      const old = JSON.parse(localStorage.getItem(reviewsKey)) || [];
      old.push(review);
      localStorage.setItem(reviewsKey, JSON.stringify(old));

      document.getElementById("reviewText").value = "";
      selectedRating = 0;
      loadReviews();
    }

    function loadReviews() {
      const list = document.getElementById("reviewsList");
      const reviews = JSON.parse(localStorage.getItem(reviewsKey)) || [];
      if (reviews.length === 0) {
        list.innerHTML = "<p>No reviews yet. Be the first to review!</p>";
      } else {
        list.innerHTML = reviews.map(r => `
          <div class="review-card">
            <div class="stars-display">${"â˜…".repeat(r.rating)}${"â˜†".repeat(5 - r.rating)}</div>
            <p>${r.text}</p>
            <small>${r.date}</small>
          </div>
        `).join("");
      }
    }

    function goHome() {
      window.location.href = "index.html";
    }

    loadReviews();
  </script>
</body>
</html>
